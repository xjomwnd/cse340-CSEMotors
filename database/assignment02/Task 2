-- Create the database cse340joe_aqib if it doesn't exist
CREATE DATABASE IF NOT EXISTS cse340joe_aqib
    WITH
    OWNER = cse340joe
    ENCODING = 'UTF8'
    LC_COLLATE = 'en_US.UTF8'
    LC_CTYPE = 'en_US.UTF8'
    LOCALE_PROVIDER = 'libc'
    TABLESPACE = pg_default
    CONNECTION LIMIT = -1
    IS_TEMPLATE = False;

-- Switch to the newly created database
\c cse340joe_aqib;

-- Set the timezone to 'utc' for the database
ALTER DATABASE cse340joe_aqib
    SET "TimeZone" TO 'utc';

-- Grant privileges on tables to the user cse340joe by altering default privileges
ALTER DEFAULT PRIVILEGES FOR ROLE postgres
GRANT ALL ON TABLES TO cse340joe;

-- Grant privileges on sequences to the user cse340joe by altering default privileges
ALTER DEFAULT PRIVILEGES FOR ROLE postgres
GRANT ALL ON SEQUENCES TO cse340joe;

-- Grant execute privileges on functions to the user cse340joe by altering default privileges
ALTER DEFAULT PRIVILEGES FOR ROLE postgres
GRANT EXECUTE ON FUNCTIONS TO cse340joe;

-- Create the 'account' table if it doesn't exist
CREATE TABLE IF NOT EXISTS account (
    account_id SERIAL PRIMARY KEY,
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    email VARCHAR(100),
    password VARCHAR(100),
    account_type VARCHAR(50)
);

-- Insert the new record into the 'account' table
INSERT INTO account (first_name, last_name, email, password, account_type)
VALUES ('Tony', 'Stark', 'tony@starkent.com', 'Iam1ronM@n', 'Customer');
